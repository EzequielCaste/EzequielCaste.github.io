<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>ClimApp</title>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css">
</head>
<body>
<div class="ui container"></div>
	<div class="ui raised very padded text container segment">
		<h2>Temparatura Actual</h2>
			<span id="ciudad"></span>
			<span id="temperatura"></span>Â°C
			<div id="imagen"></div>
	</div>		

<script type="text/javascript">
	let lat, lon;
	let ciudad = document.getElementById('ciudad');
	let temperatura = document.getElementById("temperatura")
	let imagen = document.getElementById("imagen")
	
	if ("geolocation" in navigator) {
		/* geolocation is available */
		navigator.geolocation.getCurrentPosition(function(position) {
		lat = position.coords.latitude
		lon = position.coords.longitude
		//console.log(lat,lon)
		let url = "https://api.weatherbit.io/v2.0/current?lat="+lat+"&lon="+lon+"&key=2dfd464c6ff5426c863f53196846a228"

		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
		    if (this.readyState == 4 && this.status == 200) {
		    	let parsedData = JSON.parse(this.responseText)

		      ciudad.innerText = parsedData.data[0].city_name
		      temperatura.innerText = parsedData.data[0].temp		      
		      imagen.innerHTML = '<img style="height: 40px;" src="https://www.weatherbit.io/static/img/icons/'+parsedData.data[0].weather.icon+'.png">'

		    }
		  };
		  xhttp.open("GET", url, true);
		  xhttp.send();
		

		  
  
});
} else {
  /* geolocation IS NOT available */
}
</script>
</body>
</html>